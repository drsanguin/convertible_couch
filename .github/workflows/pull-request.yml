name: Pull Request

on:
  pull_request:
    branches: [ "main", "develop" ]

env:
  CARGO_TERM_COLOR: always

jobs:
  check-pull-request:
    name: Check Pull Request ğŸ“
    runs-on: windows-latest

    steps:
    - name: Checkout Repository â¬‡ï¸
      uses: actions/checkout@v5
      with:
        fetch-depth: 0
        submodules: true

    - name: Setup Dev Environment ğŸ§°
      uses: ./.github/actions/setup-dev-environment

    - name: Check Coding Style ğŸ“
      run: cargo fmt --check --all

    - name: Compile Project ğŸ—ï¸
      run: cargo build --all-targets --verbose
      env:
        RUSTFLAGS: -D warnings

    - name: Run Linting ğŸ“
      uses: ./.github/actions/run-linting

    - name: Run Tests ğŸ§ª
      run: cargo test --verbose -- --nocapture

    - name: Run Mutation Tests ğŸ§Ÿ
      uses: ./.github/actions/run-mutation-testing

    - name: Run Smoke Tests ğŸš¬
      run: cargo run info -l trace

    - name: Run Benchmarks â±ï¸
      run: cargo test --benches

    - name: Upload Code Coverage ğŸ“Š
      uses: ./.github/actions/upload-code-coverage
      with:
        github-token: ${{ secrets.GITHUB_TOKEN }}